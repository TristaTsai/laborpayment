<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>勞務報酬單（穩定輸出版）</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: system-ui, -apple-system, "Noto Sans TC", sans-serif;
      padding: 24px;
      background: #f5f5f5;
    }
    .sheet {
      background: #fff;
      padding: 32px;
      max-width: 794px; /* A4 寬 */
      margin: auto;
      box-shadow: 0 0 8px rgba(0,0,0,.1);
    }
    h1 {
      text-align: center;
      margin-bottom: 24px;
    }
    .row {
      margin-bottom: 12px;
    }
    .label {
      font-weight: 600;
    }
    button {
      margin: 24px auto;
      display: block;
      font-size: 18px;
      padding: 12px 24px;
    }
  </style>
</head>

<body>

  <div id="pdfArea" class="sheet">
    <h1>勞務報酬單</h1>

    <div class="row"><span class="label">公司名稱：</span>東點娛樂有限公司</div>
    <div class="row"><span class="label">專案名稱：</span>瑞鼎科技尾牙晚宴</div>
    <div class="row"><span class="label">勞務內容：</span>禮賓接待</div>
    <div class="row"><span class="label">所得類別：</span>9A 執行業務所得</div>
    <div class="row"><span class="label">金額：</span>NT$ 6,000</div>
  </div>

  <button id="downloadPdf">下載 PDF</button>

  <!-- html2canvas -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <!-- jsPDF -->
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script>
    document.getElementById("downloadPdf").addEventListener("click", async function () {
      const area = document.getElementById("pdfArea");

      const canvas = await html2canvas(area, {
        scale: 2,
        useCORS: true
      });

      const imgData = canvas.toDataURL("image/png");
      const { jsPDF } = window.jspdf;
      const pdf = new jsPDF("p", "mm", "a4");

      const pdfWidth = 210;
      const pdfHeight = (canvas.height * pdfWidth) / canvas.width;

      pdf.addImage(imgData, "PNG", 0, 0, pdfWidth, pdfHeight);
      pdf.save("labor-form.pdf");
    });
  </script>
</body>
</html>